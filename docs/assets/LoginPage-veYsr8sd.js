import{_ as F,u as G,g as d,h as V,c as l,a as s,i as p,t as v,j as y,k as c,v as k,l as q,m as B,n as H,p as J,o as a}from"./index-Dl4BBGXX.js";const K={class:"auth-page"},Q={class:"auth-container"},W={class:"auth-card card no-hover"},X={class:"auth-header"},Y={key:0,class:"free-badge"},Z={class:"form-group"},ee={key:0,class:"error-message"},se=["disabled"],te={key:0,class:"spinner"},le={key:1},ae={class:"step-info"},oe={class:"email-display"},re={class:"form-group"},ne={class:"password-wrapper"},ue=["type"],ie={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},de={key:1,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ve={key:0,class:"error-message"},pe=["disabled"],ce={key:0,class:"spinner"},me={key:1},we=["disabled"],fe={key:0},ye={key:1},he={class:"step-info"},be={class:"email-display"},ge={key:0,class:"spam-warning"},_e={class:"form-group"},ke={key:0,class:"error-message"},xe=["disabled"],Ce={key:0,class:"spinner"},Pe={key:1},Me={class:"form-group"},Se={class:"password-wrapper"},Ve=["type"],qe={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Be={key:1,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ue={class:"form-group"},Oe={class:"password-wrapper"},Ae=["type"],Ne={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Re={key:1,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ee={key:0,class:"error-message"},$e=["disabled"],De={key:0,class:"spinner"},Le={key:1},ze={class:"step-info"},Ie={class:"email-display"},Te={key:0,class:"spam-warning"},je={class:"form-group"},Fe={key:0,class:"error-message"},Ge=["disabled"],He={key:0,class:"spinner"},Je={key:1},Ke={class:"form-group"},Qe={class:"form-group"},We={key:0,class:"error-message"},Xe=["disabled"],Ye={key:0,class:"spinner"},Ze={key:1},es={__name:"LoginPage",setup(ss){const U=H(),R=J(),h=G(),u=d("email"),O=d(!1),i=d(""),b=d(""),g=d(""),w=d(""),M=d(""),f=d(""),m=d(""),S=d(""),o=d(!1),_=d(!1),t=d(""),x=d(!1),C=d(!1),P=d(!1),A=V(()=>{var n;const r=["outlook.com","hotmail.com","live.com","msn.com"],e=(n=i.value.split("@").pop())==null?void 0:n.toLowerCase();return r.includes(e||"")}),E=V(()=>{switch(u.value){case"email":return"ورود یا ثبت نام";case"password":return"ورود";case"otp":return"تایید ایمیل";case"set-password":return"ثبت نام";case"reset-otp":return"بازیابی رمز عبور";case"reset-password":return"رمز عبور جدید";default:return"ورود یا ثبت نام"}}),$=V(()=>{switch(u.value){case"email":return"ایمیل خود را وارد کنید";case"password":return"رمز عبور خود را وارد کنید";case"otp":return"کد ارسال شده را وارد کنید";case"set-password":return"رمز عبور جدید انتخاب کنید";case"reset-otp":return"کد بازیابی را وارد کنید";case"reset-password":return"رمز عبور جدید انتخاب کنید";default:return""}});async function D(){if(!i.value){t.value="لطفا ایمیل را وارد کنید";return}o.value=!0,t.value="";const r=await h.checkEmail(i.value);if(!r.success){o.value=!1,t.value=r.message||"خطا در بررسی ایمیل";return}if(r.exists)O.value=!1,u.value="password",o.value=!1;else{O.value=!0;const e=await h.requestOtp(i.value);o.value=!1,e.success?u.value="otp":t.value=e.message||"خطا در ارسال کد تایید"}}async function N(){if(!b.value){t.value="لطفا رمز عبور را وارد کنید";return}o.value=!0,t.value="";const r=await h.login(i.value,b.value);if(o.value=!1,r.success){localStorage.setItem("userEmail",i.value);const e=R.query.redirect||"/dashboard";U.push(e)}else t.value=r.message||"خطا در ورود"}async function L(){if(!g.value||g.value.length!==6){t.value="لطفا کد ۶ رقمی را وارد کنید";return}o.value=!0,t.value="";const r=await h.verifyOtp(i.value,g.value);o.value=!1,r.success?u.value="set-password":t.value=r.message||"کد تایید نامعتبر است"}async function z(){if(!w.value||w.value.length<6){t.value="رمز عبور باید حداقل ۶ کاراکتر باشد";return}if(w.value!==M.value){t.value="رمز عبور و تکرار آن یکسان نیستند";return}o.value=!0,t.value="";const r=await h.register(i.value,w.value);o.value=!1,r.success?(localStorage.setItem("userEmail",i.value),U.push("/dashboard")):t.value=r.message||"خطا در ثبت نام"}async function I(){_.value=!0,t.value="";try{const r=await B.post("/api/auth/request-reset-otp",{email:i.value});_.value=!1,r.success?u.value="reset-otp":t.value=r.message||"خطا در ارسال کد بازیابی"}catch{_.value=!1,t.value="خطا در اتصال به سرور"}}async function T(){if(!f.value||f.value.length!==6){t.value="کد بازیابی باید ۶ رقم باشد";return}o.value=!0,t.value="";try{const r=await B.post("/api/auth/verify-otp",{email:i.value,otp:f.value});o.value=!1,r.success?u.value="reset-password":t.value=r.message||"کد بازیابی نامعتبر است"}catch{o.value=!1,t.value="خطا در اتصال به سرور"}}async function j(){if(!m.value||m.value.length<6){t.value="رمز عبور باید حداقل ۶ کاراکتر باشد";return}if(m.value!==S.value){t.value="رمز عبور و تکرار آن یکسان نیستند";return}o.value=!0,t.value="";try{const r=await B.post("/api/auth/reset-password",{email:i.value,otp:f.value,newPassword:m.value});o.value=!1,r.success?(b.value=m.value,await N()):t.value=r.message||"خطا در تغییر رمز عبور"}catch{o.value=!1,t.value="خطا در اتصال به سرور"}}return(r,e)=>(a(),l("div",K,[s("div",Q,[s("div",W,[s("div",X,[u.value==="email"?(a(),l("div",Y,[...e[14]||(e[14]=[s("span",null,"۷ روز رایگان",-1)])])):p("",!0),s("h1",null,v(E.value),1),s("p",null,v($.value),1)]),u.value==="email"?(a(),l("form",{key:0,onSubmit:y(D,["prevent"]),class:"auth-form"},[s("div",Z,[e[15]||(e[15]=s("label",{class:"form-label",for:"email"},"ایمیل",-1)),c(s("input",{type:"email",id:"email","onUpdate:modelValue":e[0]||(e[0]=n=>i.value=n),class:"form-input",placeholder:"email@example.com",required:"",dir:"ltr"},null,512),[[k,i.value]])]),t.value?(a(),l("div",ee,v(t.value),1)):p("",!0),s("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:o.value,style:{width:"100%"}},[o.value?(a(),l("span",te)):(a(),l("span",le,"ادامه"))],8,se)],32)):u.value==="password"?(a(),l("form",{key:1,onSubmit:y(N,["prevent"]),class:"auth-form"},[s("div",ae,[s("span",oe,v(i.value),1),s("button",{type:"button",class:"btn btn-sm btn-secondary change-email-btn",onClick:e[1]||(e[1]=n=>u.value="email")},"تغییر")]),s("div",re,[e[18]||(e[18]=s("label",{class:"form-label",for:"password"},"رمز عبور",-1)),s("div",ne,[c(s("input",{type:x.value?"text":"password",id:"password","onUpdate:modelValue":e[2]||(e[2]=n=>b.value=n),class:"form-input",placeholder:"••••••••",required:"",dir:"ltr"},null,8,ue),[[q,b.value]]),s("button",{type:"button",class:"password-toggle",onClick:e[3]||(e[3]=n=>x.value=!x.value)},[x.value?(a(),l("svg",ie,[...e[16]||(e[16]=[s("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},null,-1),s("line",{x1:"1",y1:"1",x2:"23",y2:"23"},null,-1)])])):(a(),l("svg",de,[...e[17]||(e[17]=[s("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},null,-1),s("circle",{cx:"12",cy:"12",r:"3"},null,-1)])]))])])]),t.value?(a(),l("div",ve,v(t.value),1)):p("",!0),s("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:o.value,style:{width:"100%"}},[o.value?(a(),l("span",ce)):(a(),l("span",me,"ورود"))],8,pe),s("button",{type:"button",class:"forgot-password-btn",onClick:I,disabled:_.value},[_.value?(a(),l("span",fe,"در حال ارسال...")):(a(),l("span",ye,"فراموشی رمز عبور"))],8,we)],32)):u.value==="otp"?(a(),l("form",{key:2,onSubmit:y(L,["prevent"]),class:"auth-form"},[s("div",he,[e[19]||(e[19]=s("p",null,"کد تایید به ایمیل شما ارسال شد",-1)),s("span",be,v(i.value),1),A.value?(a(),l("p",ge,"⚠️ حتماً پوشه اسپم را بررسی کنید")):p("",!0)]),s("div",_e,[e[20]||(e[20]=s("label",{class:"form-label",for:"otp"},"کد تایید",-1)),c(s("input",{type:"text",id:"otp","onUpdate:modelValue":e[4]||(e[4]=n=>g.value=n),class:"form-input otp-input",placeholder:"۱۲۳۴۵۶",maxlength:"6",required:"",dir:"ltr"},null,512),[[k,g.value]])]),t.value?(a(),l("div",ke,v(t.value),1)):p("",!0),s("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:o.value,style:{width:"100%"}},[o.value?(a(),l("span",Ce)):(a(),l("span",Pe,"تایید"))],8,xe),s("button",{type:"button",class:"btn btn-secondary",onClick:e[5]||(e[5]=n=>u.value="email"),style:{width:"100%"}}," تغییر ایمیل ")],32)):u.value==="set-password"?(a(),l("form",{key:3,onSubmit:y(z,["prevent"]),class:"auth-form"},[e[27]||(e[27]=s("div",{class:"step-info"},[s("p",null,"یک رمز عبور برای حساب خود انتخاب کنید")],-1)),s("div",Me,[e[23]||(e[23]=s("label",{class:"form-label",for:"newPassword"},"رمز عبور",-1)),s("div",Se,[c(s("input",{type:C.value?"text":"password",id:"newPassword","onUpdate:modelValue":e[6]||(e[6]=n=>w.value=n),class:"form-input",placeholder:"••••••••",required:"",dir:"ltr"},null,8,Ve),[[q,w.value]]),s("button",{type:"button",class:"password-toggle",onClick:e[7]||(e[7]=n=>C.value=!C.value)},[C.value?(a(),l("svg",qe,[...e[21]||(e[21]=[s("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},null,-1),s("line",{x1:"1",y1:"1",x2:"23",y2:"23"},null,-1)])])):(a(),l("svg",Be,[...e[22]||(e[22]=[s("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},null,-1),s("circle",{cx:"12",cy:"12",r:"3"},null,-1)])]))])])]),s("div",Ue,[e[26]||(e[26]=s("label",{class:"form-label",for:"confirmPassword"},"تکرار رمز عبور",-1)),s("div",Oe,[c(s("input",{type:P.value?"text":"password",id:"confirmPassword","onUpdate:modelValue":e[8]||(e[8]=n=>M.value=n),class:"form-input",placeholder:"••••••••",required:"",dir:"ltr"},null,8,Ae),[[q,M.value]]),s("button",{type:"button",class:"password-toggle",onClick:e[9]||(e[9]=n=>P.value=!P.value)},[P.value?(a(),l("svg",Ne,[...e[24]||(e[24]=[s("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},null,-1),s("line",{x1:"1",y1:"1",x2:"23",y2:"23"},null,-1)])])):(a(),l("svg",Re,[...e[25]||(e[25]=[s("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},null,-1),s("circle",{cx:"12",cy:"12",r:"3"},null,-1)])]))])])]),t.value?(a(),l("div",Ee,v(t.value),1)):p("",!0),s("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:o.value,style:{width:"100%"}},[o.value?(a(),l("span",De)):(a(),l("span",Le,"ثبت نام"))],8,$e)],32)):u.value==="reset-otp"?(a(),l("form",{key:4,onSubmit:y(T,["prevent"]),class:"auth-form"},[s("div",ze,[e[28]||(e[28]=s("p",null,"کد بازیابی به ایمیل شما ارسال شد",-1)),s("span",Ie,v(i.value),1),A.value?(a(),l("p",Te,"⚠️ حتماً پوشه اسپم را بررسی کنید")):p("",!0)]),s("div",je,[e[29]||(e[29]=s("label",{class:"form-label",for:"resetOtp"},"کد بازیابی",-1)),c(s("input",{type:"text",id:"resetOtp","onUpdate:modelValue":e[10]||(e[10]=n=>f.value=n),class:"form-input otp-input",placeholder:"۱۲۳۴۵۶",maxlength:"6",required:"",dir:"ltr"},null,512),[[k,f.value]])]),t.value?(a(),l("div",Fe,v(t.value),1)):p("",!0),s("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:o.value,style:{width:"100%"}},[o.value?(a(),l("span",He)):(a(),l("span",Je,"تایید"))],8,Ge),s("button",{type:"button",class:"btn btn-secondary",onClick:e[11]||(e[11]=n=>u.value="password"),style:{width:"100%"}}," بازگشت ")],32)):u.value==="reset-password"?(a(),l("form",{key:5,onSubmit:y(j,["prevent"]),class:"auth-form"},[e[32]||(e[32]=s("div",{class:"step-info"},[s("p",null,"رمز عبور جدید خود را وارد کنید")],-1)),s("div",Ke,[e[30]||(e[30]=s("label",{class:"form-label",for:"resetNewPassword"},"رمز عبور جدید",-1)),c(s("input",{type:"password",id:"resetNewPassword","onUpdate:modelValue":e[12]||(e[12]=n=>m.value=n),class:"form-input",placeholder:"••••••••",required:"",dir:"ltr"},null,512),[[k,m.value]])]),s("div",Qe,[e[31]||(e[31]=s("label",{class:"form-label",for:"resetConfirmPassword"},"تکرار رمز عبور",-1)),c(s("input",{type:"password",id:"resetConfirmPassword","onUpdate:modelValue":e[13]||(e[13]=n=>S.value=n),class:"form-input",placeholder:"••••••••",required:"",dir:"ltr"},null,512),[[k,S.value]])]),t.value?(a(),l("div",We,v(t.value),1)):p("",!0),s("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:o.value,style:{width:"100%"}},[o.value?(a(),l("span",Ye)):(a(),l("span",Ze,"تغییر رمز عبور"))],8,Xe)],32)):p("",!0)])])]))}},ls=F(es,[["__scopeId","data-v-6de00a0f"]]);export{ls as default};
